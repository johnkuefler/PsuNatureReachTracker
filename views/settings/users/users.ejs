<!DOCTYPE html>
<html>
<%- include('../../partials/header', {title: 'Nature Reach - Users'}); %>

<body>
  <% include ../../partials/navbar %>
  <br>

  <div class="container">
    <h1>Users</h1>

    <a href="./users/create" class="btn mb-2 btn-primary">+ Create User</a> <a href="./users/export"class="btn-lg mb-2 btn-success">Export</a>

    <table id="userTable" class="table table-bordered table-striped">

      <thead>
        <tr>
          <td>Profile Image</td>
          <td>Email</td>
          <td>First Name</td>
          <td>Last Name</td>
          <td>Register Date</td>
          <td>Role</td>
          <td>Action</td>
        </tr>
      </thead>

      <% for(var i=0; i < data.length; i++) { %>
      <tr>
        <td>
          <% if (data[i].profileImage.data == "") {%>
            <img style="width:100px;height:100px;" src="../images/defaultuserprofilepic.png">
            </>
            <% } else { %>
                <img style="width:100px;height:100px;" src="data:image/<%= data[i].profileImage.contentType%>;base64,
                <%= data[i].profileImage.data.toString('base64')%>">
            <% } %>
        </td>
        <td><%=data[i].email%></td>
        <td><%=data[i].firstName%></td>
        <td><%=data[i].lastName%></td>
        <td><%=data[i].registerDate.toLocaleDateString("en-US")%></td>
        <td><%=data[i].role%></td>
        <td><a href="./users/update?_id=<%= data[i]._id %>"><span style="font-size: 20px;"><i class="fa fa-pencil"></i></span></a> | <a 
          href="./users/delete?_id=<%= data[i]._id %>" 
          onclick="return confirm('Are you sure you want to delete this?')"><span style="font-size: 20px;"><i class="fa fa-trash"></i></span></a> | <a
        href="./users/updateimage?_id=<%= data[i]._id %>"><span style="font-size: 20px;"><i class="fa fa-image"></i></span></a>
      </td>
      </tr>
      <% } %>
    </table>
  </div>

  <% include ../../partials/scripts %>

  <script type="text/javascript">
    $(document).ready(function () {
      $('#userTable').DataTable();
    });
  </script>
</body>

</html>